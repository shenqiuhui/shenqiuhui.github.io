(function(){var l=window||this,j=l.BLOG.even,g=l.BLOG.$,h=g("#search"),n=g("#search-wrap"),m=g("#key"),o=g("#back"),a=g("#search-panel"),q=g("#search-result"),s=g("#search-tpl").innerHTML,i=(l.BLOG.ROOT+"/content.json").replace(/\/{2}/g,"/"),w=null,f;function d(y){var x=new XMLHttpRequest();x.open("GET",i,true);x.onload=function(){if(this.status>=200&&this.status<300){var z=JSON.parse(this.response);f=z instanceof Array?z:z.posts;y&&y(f)}else{console.error(this.statusText)}};x.onerror=function(){console.error(this.statusText)};x.send()}function b(x,y){if(!f&&x!==""){clearInterval(w);w=setTimeout(function(){d(y)},500)}else{y(f)}}function v(x,y){return x.replace(/\{\w+\}/g,function(z){var A=z.replace(/\{|\}/g,"");return y[A]||""})}var e=l.BLOG.noop;var p=g("html");var u={show:function(){l.innerWidth<760?p.classList.add("lock-size"):e;a.classList.add("in")},hide:function(){l.innerWidth<760?p.classList.remove("lock-size"):e;a.classList.remove("in")}};function t(z,x){this.key;var y="";if(z.length){y=z.map(function(A){return v(s,{tip:A.title,title:A.title.replace(x,function(B){return'<span class="search-key-highlight">'+B+"</span>"}),path:(l.BLOG.ROOT+"/"+A.path).replace(/\/{2,}/g,"/"),date:new Date(A.date).toLocaleDateString(),tags:A.tags.map(function(B){var F=' class="search-key-highlight"';var C=B.name.match(x)||[];var E=C[0]===B.name?F:"";var D=B.name.replace(x,function(G){return G?"<span"+F+">"+G+"</span>":G}).trim();return"<span "+E+">#"+D+"</span>"}).join("")})}).join("")}else{y='<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>'}q.innerHTML=y}function r(y,x){x.lastIndex=0;return x.test(y)}function c(y,x){return r(y.title,x)||y.tags.some(function(z){return r(z.name,x)})}function k(z){var y=this.value.trim();if(!y&&y!==""){return}var x=new RegExp(y.replace(/[ ]/g,"|"),"gmi");b(y,function(B){if(B){var A=B.filter(function(C){return c(C,x)});t(A,x);u.show()}});z.preventDefault()}d();h.addEventListener(j,function(){n.classList.toggle("in");m.value="";n.classList.contains("in")?m.focus():m.blur()});o.addEventListener(j,function(){n.classList.remove("in");u.hide()});document.addEventListener(j,function(x){if(x.target.id!=="key"&&j==="click"){u.hide()}});m.addEventListener("input",k);m.addEventListener(j,k)}).call(this);
